#!/bin/bash

# OORT Blockchain Vulnerability Demonstration Script
# Shows remote code execution via Clang-related buffer overflow

echo "======================================================"
echo "OORT BLOCKCHAIN - CRITICAL VULNERABILITY DEMONSTRATION"
echo "Remote Code Execution via Buffer Overflow"
echo "======================================================"
echo

# Compile the demonstration
echo "[*] Compiling exploitation demonstration..."
clang++ -std=c++17 -O0 -g -fsanitize=address -pthread \
    -o oort_exploit_demo \
    oort_clang_exploitation_demo.cpp

if [ $? -eq 0 ]; then
    echo "[+] Compilation successful with AddressSanitizer enabled"
else
    echo "[!] Compilation failed, trying with g++..."
    g++ -std=c++17 -O0 -g -pthread \
        -o oort_exploit_demo \
        oort_clang_exploitation_demo.cpp
fi

echo

# Run the demonstration
if [ -f "./oort_exploit_demo" ]; then
    echo "[*] Running vulnerability demonstration..."
    echo "    This will show how a remote attacker could exploit"
    echo "    the buffer overflow in OORT's P2P networking code"
    echo

    ./oort_exploit_demo

    echo
    echo "[*] Demonstration completed!"
    echo "[*] This showed how the vulnerability could be exploited"
    echo "    to achieve remote code execution on OORT nodes"
else
    echo "[!] Compilation failed. Cannot run demonstration."
fi

echo
echo "======================================================"
echo "VIDEO RECORDING INSTRUCTIONS:"
echo "======================================================"
echo "To create a video demonstration:"
echo "1. Start screen recording (QuickTime/OBS)"
echo "2. Run: ./run_oort_exploit_demo.sh"
echo "3. Show the terminal output demonstrating the attack"
echo "4. Explain the buffer overflow and its impact"
echo "5. Stop recording when exploitation completes"
echo
echo "Key points to highlight in video:"
echo "- Buffer overflow in mcp/p2p/peer.cpp:106"
echo "- Integer overflow leading to heap corruption"
echo "- Race condition in handshake operations"
echo "- Remote code execution capability"
echo "- AddressSanitizer detection output"
echo "======================================================"