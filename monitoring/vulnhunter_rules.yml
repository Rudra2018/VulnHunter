# Prometheus Alert Rules for VulnHunter

groups:
  - name: vulnhunter_alerts
    rules:
      - alert: VulnHunterAPIDown
        expr: up{job="vulnhunter-api"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "VulnHunter API is down"
          description: "VulnHunter API has been down for more than 1 minute"

      - alert: VulnHunterModelNotReady
        expr: vulnhunter_model_ready{model="comprehensive_vulnhunter"} == 0
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "VulnHunter model not ready"
          description: "VulnHunter model has not been ready for more than 5 minutes"

      - alert: VulnHunterHighErrorRate
        expr: rate(vulnhunter_requests_total{status="error"}[5m]) > 0.1
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "High error rate in VulnHunter API"
          description: "VulnHunter API error rate is {{ $value }} per second"

      - alert: VulnHunterHighFabricationDetection
        expr: rate(vulnhunter_fabrication_detected_total[1h]) > 10
        for: 0m
        labels:
          severity: info
        annotations:
          summary: "High fabrication detection rate"
          description: "Unusual number of fabricated analyses detected: {{ $value }} per hour"

      - alert: VulnHunterMemoryUsage
        expr: container_memory_usage_bytes{name="vulnhunter-api"} / container_spec_memory_limit_bytes{name="vulnhunter-api"} > 0.8
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "VulnHunter high memory usage"
          description: "VulnHunter container memory usage is above 80%"