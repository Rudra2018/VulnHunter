# VulnHunter V15 Azure ML Job Configuration
# Revolutionary AI Vulnerability Detection - Massive Scale Training

$schema: https://azuremlschemas.azureedge.net/latest/commandJob.schema.json
type: command

# Job Details
display_name: VulnHunter-V15-Massive-Scale-Training
description: Revolutionary enterprise-grade multi-platform vulnerability detection training on massive datasets
tags:
  model: VulnHunter-V15
  version: "15.0.0"
  dataset_size: "300TB+"
  training_type: "massive-scale"
  mathematical_techniques: "8-advanced"
  platforms: "multi-platform"

# Compute Configuration
compute: vulnhunter-v15-cpu-cluster

# Environment
environment:
  name: vulnhunter-v15-comprehensive
  version: "1"
  image: mcr.microsoft.com/azureml/pytorch-1.12-ubuntu20.04-py38-cuda11.6-gpu
  conda_file: vulnhunter_v15_conda.yml

# Code and Data
code: ./
inputs:
  training_data:
    type: uri_folder
    path: azureml://datastores/workspaceblobstore/paths/vulnhunter_v15_massive_data/

# Training Configuration
command: >-
  python vulnhunter_v15_massive_training.py
  --training_data ${{inputs.training_data}}
  --model_name "VulnHunter-V15-Enterprise"
  --model_version "15.0.0"
  --max_epochs 500
  --batch_size_gpu 64
  --batch_size_cpu 128
  --learning_rate 1e-4
  --max_cpu_cores 128
  --memory_limit_gb 512
  --distributed true
  --mixed_precision true
  --mathematical_techniques true
  --enterprise_integration true
  --enable_monitoring true
  --save_checkpoints true
  --early_stopping_patience 50
  --validation_interval 500

# Resource Configuration
resources:
  instance_count: 4
  shm_size: 8g

# Environment Variables
environment_variables:
  PYTORCH_CUDA_ALLOC_CONF: "max_split_size_mb:512"
  OMP_NUM_THREADS: "128"
  MKL_NUM_THREADS: "128"
  CUDA_VISIBLE_DEVICES: "0,1,2,3,4,5,6,7"
  WANDB_PROJECT: "vulnhunter-v15-enterprise"
  AZURE_ML_TRAINING: "true"

# Outputs
outputs:
  model_output:
    type: uri_folder
    path: azureml://datastores/workspaceblobstore/paths/models/vulnhunter-v15/
  training_logs:
    type: uri_folder
    path: azureml://datastores/workspaceblobstore/paths/logs/vulnhunter-v15/
  checkpoints:
    type: uri_folder
    path: azureml://datastores/workspaceblobstore/paths/checkpoints/vulnhunter-v15/

# Monitoring and Logging
logging:
  level: INFO

# Retry Policy
retry_settings:
  max_retries: 2
  timeout: 604800  # 7 days

# Resource Limits
limits:
  timeout: 604800  # 7 days maximum